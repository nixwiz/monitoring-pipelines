---
type: Asset
api_version: core/v2
metadata:
  name: sensu-influxdb-handler
  labels:
  annotations:
    io.sensu.bonsai.url: https://bonsai.sensu.io/assets/sensu/sensu-influxdb-handler
    io.sensu.bonsai.api_url: https://bonsai.sensu.io/api/v1/assets/sensu/sensu-influxdb-handler
    io.sensu.bonsai.tier: Supported
    io.sensu.bonsai.version: 3.1.2
    io.sensu.bonsai.namespace: sensu
    io.sensu.bonsai.name: sensu-influxdb-handler
    io.sensu.bonsai.tags: ''
spec:
  url: https://assets.bonsai.sensu.io/b28f8719a48aa8ea80c603f97e402975a98cea47/sensu-influxdb-handler_3.1.2_linux_amd64.tar.gz
  sha512: 612c6ff9928841090c4d23bf20aaf7558e4eed8977a848cf9e2899bb13a13e7540bac2b63e324f39d9b1257bb479676bc155b24e21bf93c722b812b0f15cb3bd
  filters:
    - entity.system.os == 'linux'
    - entity.system.arch == 'amd64'
---
type: Secret
api_version: secrets/v1
metadata:
  name: influxdb_url
spec:
  provider: env
  id: INFLUXDB_URL
---
type: Secret
api_version: secrets/v1
metadata:
  name: influxdb_db
spec:
  provider: env
  id: INFLUXDB_DB
---
type: Secret
api_version: secrets/v1
metadata:
  name: influxdb_user
spec:
  provider: env
  id: INFLUXDB_USER
---
type: Secret
api_version: secrets/v1
metadata:
  name: influxdb_password
spec:
  provider: env
  id: INFLUXDB_PASSWORD
---
type: Handler
api_version: core/v2
metadata:
  name: influxdb
  spec:
    type: pipe
    command: sensu-influxdb-handler -a $INFLUXDB_URL -d $INFLUXDB_DB -u $INFLUXDB_USER -p $INFLUXDB_PASSWORD
    timeout: 10
    filters:
    - has_metrics
    runtime_assets:
    - sensu-influxdb-handler
    secrets:
    - name: INFLUXDB_URL
      secret: influxdb_url
    - name: INFLUXDB_DB
      secret: influxdb_db
    - name: INFLUXDB_USER
      secret: influxdb_user
    - name: INFLUXDB_PASSWORD
      secret: influxdb_password
